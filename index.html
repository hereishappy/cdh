<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Performance Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Google Sans', 'Roboto', Arial, sans-serif;
            background-color: #fafafa;
            color: #202124;
            line-height: 1.4;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
            color: white;
            padding: 16px 24px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
        }

        .header-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .header-center {
            text-align: center;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            gap: 4px;
            text-align: right;
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: 500;
            letter-spacing: -0.5px;
        }

        .header-info {
            font-size: 14px;
            font-weight: 400;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-icon {
            width: 16px;
            height: 16px;
            opacity: 0.8;
        }

        .loading {
            opacity: 0.7;
            font-style: italic;
        }

        /* Main Content */
        .main-container {
            position: relative;
            width: 100%;
            min-height: calc(100vh - 120px);
            display: flex;
            flex-direction: column;
        }

        .dashboard-container {
            flex: 1;
            position: relative;
            width: 100%;
            background: white;
            border-radius: 8px;
            margin: 16px;
            box-shadow: 0 1px 6px rgba(32,33,36,0.1);
            overflow: hidden;
        }

        .dashboard-iframe {
            width: 100%;
            height: calc(100vh - 180px);
            min-height: 600px;
            border: none;
            display: block;
        }

        /* Footer - positioned to cover Looker Studio's privacy text */
        .footer {
            position: absolute;
            bottom: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border-top: 1px solid #e8eaed;
            border-left: 1px solid #e8eaed;
            border-radius: 8px 0 0 0;
            padding: 12px 16px;
            max-width: 400px;
            z-index: 999;
            box-shadow: -2px -2px 10px rgba(0,0,0,0.05);
        }

        .safety-suggestions {
            font-size: 12px;
            color: #5f6368;
            line-height: 1.3;
            font-weight: 400;
        }

        .safety-title {
            font-weight: 500;
            color: #1a73e8;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .safety-icon {
            width: 14px;
            height: 14px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }

            .header-content {
                grid-template-columns: 1fr;
                gap: 12px;
                text-align: center;
            }

            .header-left,
            .header-right {
                text-align: center;
            }

            .dashboard-title {
                font-size: 20px;
            }

            .header-info {
                justify-content: center;
                font-size: 13px;
            }

            .dashboard-container {
                margin: 8px;
                border-radius: 0;
            }

            .dashboard-iframe {
                height: calc(100vh - 160px);
                min-height: 500px;
            }

            .footer {
                position: fixed;
                bottom: 0;
                right: 0;
                left: 0;
                max-width: none;
                border-radius: 0;
                border-left: none;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .header-info {
                flex-direction: column;
                gap: 4px;
            }

            .dashboard-title {
                font-size: 18px;
            }

            .header-info {
                font-size: 12px;
            }
        }

        /* Smooth transitions */
        .header-info,
        .safety-suggestions {
            transition: opacity 0.3s ease;
        }

        /* Ensure footer covers Looker Studio elements */
        .main-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 400px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            z-index: 998;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .main-container::after {
                width: 100%;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="header-info">
                    <svg class="info-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    <span id="location" class="loading">Loading location...</span>
                </div>
                <div class="header-info">
                    <svg class="info-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/>
                    </svg>
                    <span id="weather" class="loading">Loading weather...</span>
                </div>
            </div>
            <div class="header-center">
                <h1 class="dashboard-title">The Site Performance Dashboard</h1>
            </div>
            <div class="header-right">
                <div class="header-info">
                    <svg class="info-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <span id="current-time" class="loading">Loading time...</span>
                </div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <div class="dashboard-container">
            <iframe 
                class="dashboard-iframe"
                src="https://lookerstudio.google.com/embed/reporting/269739d7-52c4-4c55-9f98-65fa02547f85/page/p_v8ez92uavd" 
                frameborder="0" 
                allowfullscreen 
                sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox">
            </iframe>
        </div>
        
        <footer class="footer">
            <div class="safety-suggestions">
                <div class="safety-title">
                    <svg class="safety-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.66 16,12.56 16,13.5V16.5C16,17.66 15.16,18.5 14,18.5H10C8.84,18.5 8,17.66 8,16.5V13.5C8,12.56 8.6,11.66 9.2,11.5V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,10V11.5H13.5V10C13.5,8.7 12.8,8.2 12,8.2Z"/>
                    </svg>
                    Safety Reminder
                </div>
                <div id="safety-text">Always ensure proper scaffolding setup, regular inspections, and certified equipment usage to maintain workplace safety standards.</div>
            </div>
        </footer>
    </main>

    <script>
        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZoneName: 'short'
            });
            document.getElementById('current-time').textContent = timeString;
        }

        // Get user location and weather
        async function getLocationAndWeather() {
            try {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(async (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        
                        // Get location name using reverse geocoding (free service)
                        try {
                            const locationResponse = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`);
                            const locationData = await locationResponse.json();
                            const locationName = locationData.city || locationData.locality || 'Unknown Location';
                            document.getElementById('location').textContent = locationName;
                        } catch (error) {
                            document.getElementById('location').textContent = 'Location Unavailable';
                        }

                        // Get weather using OpenWeatherMap (you'd need an API key for production)
                        // For demo purposes, showing placeholder
                        document.getElementById('weather').textContent = 'Weather: 72°F, Partly Cloudy';
                        
                    }, () => {
                        document.getElementById('location').textContent = 'Location Unavailable';
                        document.getElementById('weather').textContent = 'Weather Unavailable';
                    });
                } else {
                    document.getElementById('location').textContent = 'Location Not Supported';
                    document.getElementById('weather').textContent = 'Weather Unavailable';
                }
            } catch (error) {
                document.getElementById('location').textContent = 'Location Error';
                document.getElementById('weather').textContent = 'Weather Error';
            }
        }

        // Generate dynamic safety suggestions
        function generateSafetyText() {
            const suggestions = [
                "Always ensure proper scaffolding setup, regular inspections, and certified equipment usage to maintain workplace safety standards.",
                "Remember to conduct daily safety briefings, use appropriate fall protection, and maintain three points of contact when climbing.",
                "Verify load capacities, secure all materials properly, and ensure clear communication between team members during operations.",
                "Check weather conditions, inspect all connections, and maintain proper spacing between scaffold platforms and structures.",
                "Ensure workers are properly trained, equipment is certified, and emergency procedures are clearly communicated to all personnel.",
                "Conduct regular safety audits, maintain proper documentation, and ensure all safety equipment is in good working condition.",
                "Implement proper signage, establish clear work zones, and ensure adequate lighting for all scaffolding operations.",
                "Verify ground conditions, use appropriate base plates, and ensure scaffolding is level and properly braced at all times."
            ];
            
            const randomIndex = Math.floor(Math.random() * suggestions.length);
            document.getElementById('safety-text').textContent = suggestions[randomIndex];
        }

        // Initialize page
        function init() {
            updateTime();
            getLocationAndWeather();
            generateSafetyText();
            
            // Update time every second
            setInterval(updateTime, 1000);
            
            // Update safety text every 30 seconds
            setInterval(generateSafetyText, 30000);
        }

        // Start when page loads
        window.addEventListener('load', init);

        // Handle iframe loading and ensure footer coverage
        window.addEventListener('load', () => {
            const iframe = document.querySelector('.dashboard-iframe');
            iframe.addEventListener('load', () => {
                // Ensure footer stays on top after iframe loads
                setTimeout(() => {
                    const footer = document.querySelector('.footer');
                    footer.style.zIndex = '999';
                }, 500);
            });
        });
    </script>
</body>
</html>
